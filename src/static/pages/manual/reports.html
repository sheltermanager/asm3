

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Reports &mdash; ASM 46u documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Litters" href="litters.html" />
    <link rel="prev" title="Stock Control" href="stockcontrol.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ASM
          

          
          </a>

          
            
            
              <div class="version">
                46u
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="foreword.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="searching.html">Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="animals.html">Animals</a></li>
<li class="toctree-l1"><a class="reference internal" href="people.html">People</a></li>
<li class="toctree-l1"><a class="reference internal" href="movements.html">Movements</a></li>
<li class="toctree-l1"><a class="reference internal" href="documents.html">Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="animalcontrol.html">Animal Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="clinic.html">Clinic</a></li>
<li class="toctree-l1"><a class="reference internal" href="lostandfound.html">Lost and Found</a></li>
<li class="toctree-l1"><a class="reference internal" href="waitinglist.html">Waiting List</a></li>
<li class="toctree-l1"><a class="reference internal" href="generaldiary.html">General Diary</a></li>
<li class="toctree-l1"><a class="reference internal" href="accounts.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="stockcontrol.html">Stock Control</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reports</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#customising-reports">Customising Reports</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sql-keys">SQL Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ask">ASK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#var">VAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#const">CONST</a></li>
<li class="toctree-l3"><a class="reference internal" href="#report-grouping-and-calculation">Report Grouping and Calculation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#charts">Charts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#two-column-variant">Two column variant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#three-column-variant">Three column variant</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#maps">Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-updating-of-repository-reports">Automatic updating of repository reports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="litters.html">Litters</a></li>
<li class="toctree-l1"><a class="reference internal" href="onlineform.html">Online Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="paymentprocessors.html">Payment Processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="rota.html">Rota</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobile.html">Mobile Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="service.html">Service API</a></li>
<li class="toctree-l1"><a class="reference internal" href="publishing.html">Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mailmerge.html">Mail Merge Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Appendix: Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="csvimportfields.html">Appendix: CSV file import fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="databasetables.html">Appendix: Database Tables/Columns</a></li>
<li class="toctree-l1"><a class="reference internal" href="relationships.html">Appendix: Entity Relationship Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="website.html">Appendix: Integrating with Your Website</a></li>
<li class="toctree-l1"><a class="reference internal" href="onlineformfields.html">Appendix: Online Form import fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="wordkeys.html">Appendix: Wordkeys</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ASM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Reports</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/reports.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reports">
<h1>Reports<a class="headerlink" href="#reports" title="Permalink to this headline">¶</a></h1>
<p>Animal Shelter Manager offers some highly detailed reporting facilities that
fall broadly into the following categories.</p>
<p>All reports are accessed from the Reports top level-menu. By default, ASM does
not install with any reports. You must install them from
<span class="menuselection">Settings ‣ Reports ‣ Browse sheltermanager.com</span> – this
requires your ASM server to have access to the internet. There’s an “Install
Recommended” button you can use to choose the default set to install.</p>
<p>Some of the standard, most useful reports you should install are:</p>
<ul class="simple">
<li><p>Long Term Animals: Produces a detailed report of animals who have been in the
shelter longer than three months.</p></li>
<li><p>Shelter Inventory: Outputs total figures for every animal on the shelter,
broken down by species and their location within the shelter.</p></li>
<li><p>Detailed Shelter Inventory: Identical to the Shelter Inventory, except it
provides details of the individual animals as well.</p></li>
</ul>
<img alt="_images/reports_inout.png" src="_images/reports_inout.png" />
<ul class="simple">
<li><p>In/Out: Shows a detailed listing of all the animals that entered or left the
shelter between two dates.</p></li>
<li><p>In/Out Summary: Identical to the In/Out report, but only shows the bottom
line totals without information about the actual animals.</p></li>
<li><p>Animals Returned Within Six Months: Produces a detailed report of animals who
were returned to the shelter within six months of adoption (allows you to
select a date range to filter the animals down to when they were adopted).</p></li>
<li><p>Animals Returned After Six Months: Functionally the same as Animals Returned
Within Six Months, except it only shows animals who were returned after six
months of adoption.</p></li>
<li><p>Returned Animals Report: Produces a detailed report of animals (complete with
full adoption histories) who have been returned between the two dates
specified.</p></li>
<li><p>Animal Death Reasons: Produces a report listing all the reasons for which
animals have died on the shelter.</p></li>
<li><p>Monthly Donations: Charts donations taken for animals brought into the
shelter and adopted to new owners over the selected year (as well as
arbitrary donations).</p></li>
<li><p>Monthly Donations By Species: Same as monthly donations, but only for a
particular species and does not include arbitrary donations.</p></li>
<li><p>Monthly Adoptions By Species: Charts the number of adoptions of a particular
species over a selected year.</p></li>
<li><p>Monthly Adoptions By Locations: Charts the number of adoptions of a
particular species over the different shelter locations over a selected year.</p></li>
</ul>
<img alt="_images/reports_entryreasons.png" src="_images/reports_entryreasons.png" />
<ul class="simple">
<li><p>Animal Entry Reasons: Charts the different reasons for animals entering the
shelter over the selected year.</p></li>
<li><p>Animal Return Reasons: Charts the different reasons for animals being
returned to the shelter over the selected year.</p></li>
</ul>
<div class="section" id="customising-reports">
<h2>Customising Reports<a class="headerlink" href="#customising-reports" title="Permalink to this headline">¶</a></h2>
<p>In addition to the stock reports provided by the sheltermanager.com repository,
it is possible to create your own, using a simple language called “SQL” (short
for “Structured Query Language”). SQL is a language for retrieving and
formatting information - underneath, ASM uses this language to talk to its
database (Either MySQL or PostgreSQL - as the names imply, they all talk SQL).</p>
<p>The reports editing screen is located under the Settings menu, any reports you
create will integrate into the Reports menu. You can also use this screen to
rearrange and rename existing reports and charts in the system. You can also
assign “view roles” to reports. If you assign one or more view roles, then only
users in those roles will be able to run the report and see its output.</p>
<p>In addition to just creating queries, you can then format how the data is
transformed and displayed to you in the format of a report. Again, this is done
through the use of another language - HTML (HyperText Markup Language). This is
the same language used for creating web pages on the internet.</p>
<p>The report editor has a button to automatically run your query and generate the
HTML for you in a simple table format. It is worthwhile running this and then
modifying the HTML afterwards.</p>
<p>The editor will highlight the syntax of both languages for you, and if you
press <kbd class="kbd docutils literal notranslate">F11</kbd>, will allow you to edit in full screen mode. For SQL, you can use
<kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate">CTRL</kbd>+<kbd class="kbd docutils literal notranslate">SPACE</kbd></kbd> to get context-sensitive help with ASM’s tables and columns.</p>
<p>For some excellent beginner tutorials on both SQL and HTML, see
www.w3schools.com</p>
<div class="section" id="sql-keys">
<h3>SQL Keys<a class="headerlink" href="#sql-keys" title="Permalink to this headline">¶</a></h3>
<p>What happens if you want to create a report that needs to request specific
information from the user before running - eg: To filter between two dates, or
only show animals of a particular species, etc?</p>
<p>ASM offers SQL preprocessor instructions to allow you to substitute system
information, or information requested from the user at report generation time.</p>
<ul class="simple">
<li><p>$USER$ - Substitutes the current user’s name.</p></li>
<li><p>$LOCATIONFILTER$ - Substitutes the current user’s location filter (a comma
separated string of internal location IDs) or a list of all internal location
IDs if the user does not have a location filter.</p></li>
<li><p>$SITE$ - Substitutes the current user’s site ID (multi-site only).</p></li>
<li><p>$CURRENT_DATE$ - Substitutes today’s date in an appropriate string SQL format
for the current database. This saves you having to use NOW() or
CURRENT_DATE() or various other SQL functions specific to one database.</p></li>
<li><p>$CURRENT_DATE-X$ - The same as CURRENT_DATE, but subtracts X days.</p></li>
<li><p>$CURRENT_DATE+X$ - The same as CURRENT_DATE, but adds X days.</p></li>
<li><p>$PARENTKEY$ - Substitutes the field value named in the report calling this
subreport. For example, a report could pass an Animal ID as the parent key to
a subreport for filtering data correctly. When you use this key in your
report SQL, ASM assumes that this report is a subreport and will not display
it on the menu.</p></li>
<li><p>$PARENTARGX$ - Substitutes argument X passed to the subreport. For example, a
subreport generated with {SUBREPORT.Myreport.ID.ShelterCode.AnimalName} could
access the parent AnimalName field with $PARENTARG3$. When you use this key
in your report SQL, ASM assumes that this report is a subreport and will not
display it on the menu.</p></li>
<li><p>AS money[fieldname] – If you alias an output field so that it has the prefix
“money” as its name, the report engine will make sure it’s formatted as a
currency and assume that its value is a whole integer money amount (where 1
is 1 cent/pence/etc).</p></li>
</ul>
</div>
<div class="section" id="ask">
<h3>ASK<a class="headerlink" href="#ask" title="Permalink to this headline">¶</a></h3>
<p>Ask is quite a detailed key, which requests information from the user at
generation time. The basic syntax is this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ASK [TYPE] [Message]$
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are substituting any kind of string value (ASK DATE or ASK STRING), you must wrap the ASK key inside string delimiters (the apostrophe ‘) otherwise you will get SQL errors.</p>
</div>
<p>The types are outlined below:</p>
<ul class="simple">
<li><p>$ASK DATE message$ - requests a date from the user. A popup is displayed
containing the message and the user is given an ASM date control to use to
select the date. The value substituted is the date selected by the user in
SQL string format appropriate for the database you are using.</p></li>
<li><p>$ASK ANIMAL$ - requests a shelter animal. The value substituted is the animal ID.</p></li>
<li><p>$ASK FSANIMAL$ - requests a foster animal. The value substituted is the
animal ID.</p></li>
<li><p>$ASK ALLANIMAL$ - requests any animal. The value substituted is the animal ID.</p></li>
<li><p>$ASK ANIMALS$ - requests one or more shelter animals. The value substituted
is a comma separated list of animal IDs, useful for putting in an IN clause
(eg: AnimalID IN ($ASK ANIMALS$))</p></li>
<li><p>$ASK ANIMALFLAG$ - requests an animal flag.</p></li>
<li><p>$ASK PERSON$ - requests an person. The value substituted is the person ID.</p></li>
<li><p>$ASK PERSONFLAG$ - requests a person flag.</p></li>
<li><p>$ASK LITTER$ - requests a litter identifier. A popup displays a list of the
recent, active litters on the system. The value returned is the litter ID as
a string.</p></li>
<li><p>$ASK SPECIES$ - requests a species from the user. A popup is displayed
containing a dropdown of all species on the system.</p></li>
<li><p>$ASK LOCATION$ - requests an internal location from the user in the same
manner as $ASK SPECIES$</p></li>
<li><p>$ASK VOUCHER$ - requests a voucher from the user in the same manner as $ASK
SPECIES$</p></li>
<li><p>$ASK DIET$ - requests a diet from the user in the same manner as $ASK
SPECIES$</p></li>
<li><p>$ASK PAYMENTMETHOD$ - requests a payment method.</p></li>
<li><p>$ASK PAYMENTTYPE$ - requests a payment/donation type from the user in the
same manner as $ASK SPECIES$</p></li>
<li><p>$ASK LOGTYPE$ - requests a log type from the user in the same manner as $ASK
SPECIES$</p></li>
<li><p>$ASK TYPE$ - requests an animal type from the user in the same manner as $ASK
SPECIES$</p></li>
<li><p>$ASK LOOKUP message|value1,value2,value3$ - requests one from a selection of
fixed lookup values from the user.</p></li>
<li><p>$ASK NUMBER message$ - requests a numeric value from the user. A box is
popped up containing the message and the user is given a standard text box to
enter the number in. They will not be allowed to continue until a valid
number is entered. The value returned is the number.</p></li>
<li><p>$ASK STRING message$ - requests a string value from the user (eg: Name,
Address, etc.). A box is popped up containing the message and the user is
given a text box to enter the string in. The value substituted is the string.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ANIMAL, FSANIMAL and ALLANIMAL are identical in the desktop interface. They produce different choices in the mobile interface.</p>
</div>
</div>
<div class="section" id="var">
<h3>VAR<a class="headerlink" href="#var" title="Permalink to this headline">¶</a></h3>
<p>VAR works just like ASK, the only difference is that instead of substituting
the value into the SQL, it stores it to a variable name. You can then
substitute the variable multiple times in your SQL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$VAR &lt;varname&gt; [TYPE] [Message]$
</pre></div>
</div>
<p>The VAR tag should appear in your SQL before you reference the variable
created. The variable is substituted with $&#64;varname$</p>
<p>This example shows a list of animals of a selected species brought in after the
given date. The species and broughtinafter variables could be reused as many
times as we like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$VAR species SPECIES$
$VAR broughtinafter DATE The date the animals were brought in after$
SELECT AnimalName, DateBroughtIn FROM animal
WHERE SpeciesID=$@species$ AND DateBroughtIn &gt;= &#39;$@broughtinafter$&#39;
</pre></div>
</div>
</div>
<div class="section" id="const">
<h3>CONST<a class="headerlink" href="#const" title="Permalink to this headline">¶</a></h3>
<p>CONST allows you to declare a constant value for later use in your query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CONST name=value$
</pre></div>
</div>
<p>A constant must have a name and it can be accessed with $name$ (it does not
require the &#64; prefix like variables).</p>
<p>This example shows a list of all adopted animals and assigns the adoption
movement type 1 to a constant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CONST MOVEADOPT=1$

SELECT AnimalName FROM animal WHERE ActiveMovementType = $MOVEADOPT$
</pre></div>
</div>
</div>
<div class="section" id="report-grouping-and-calculation">
<h3>Report Grouping and Calculation<a class="headerlink" href="#report-grouping-and-calculation" title="Permalink to this headline">¶</a></h3>
<p>In addition, ASM allows you to do a number of transformations to the output
HTML. You define a number of “blocks” to your reports. Anyone who has used a
reporting tool (eg: Microsoft Access or Crystal) will recognise these.</p>
<ul class="simple">
<li><p>$$HEADER … HEADER$$ - The topmost section of the report should be entered
here.</p></li>
<li><p>$$FOOTER … FOOTER$$ - The bottom most section of the report should be
entered here.</p></li>
<li><p>$$BODY … BODY$$ - The main section of your report where the detail goes.</p></li>
<li><p>$$GROUP_&lt;field&gt; .. GROUP$$ - Optional grouping level. If you want to group by
a particular field in the formatted output, you should add a group block.
Within the group block you must also define a $$HEAD and $$FOOT section.</p></li>
<li><p>$$NODATA … NODATA$$$ - A special block to output if the report query returns
no data.</p></li>
<li><p>$$HTMLHEADER … HTMLHEADER$$$ - Override the report template HTML header and
supply a new one instead.</p></li>
<li><p>$$HTMLFOOTER … HTMLFOOTER$$$ - Override the report template HTML footer and
supply a new one instead.</p></li>
</ul>
<p>For example, to group on the OwnerName field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$GROUP_OwnerName
$$HEAD
&lt;h2&gt;$OwnerName&lt;/h2&gt;
$$FOOT
&lt;p&gt;Number of owners with name &#39;$OwnerName&#39;: {COUNT.OwnerName}&lt;/p&gt;
GROUP$$
</pre></div>
</div>
<p>ASM also offers a number of calculation instructions you may use in group
$$FOOT blocks and the main $$FOOTER block. These are:</p>
<ul>
<li><p>{SUM.&lt;field&gt;[.round]} - Calculates the total of a given field for a group.
Optionally, you can specify the number of decimal places to round to.</p></li>
<li><p>{COUNT.&lt;field&gt;[.distinct]} - Returns the number of records in the group.
If the optional distinct parameter is set, returns the number of unique
values of &lt;field&gt; within the group.</p></li>
<li><p>{AVG.&lt;field&gt;[.round]} - Calculates the average of a group, based on the total
of the field and the number of records. Optionally, you can specify the
number of decimal places to round to.</p></li>
<li><p>{MIN.&lt;field&gt;} - Shows the smallest value for a given field in a group</p></li>
<li><p>{MAX.&lt;field&gt;} - Shows the largest value for a given field in a group</p></li>
<li><p>{FIRST.&lt;field&gt;} - Returns the first value for a given field in a group</p></li>
<li><p>{IMAGE.&lt;animalid&gt;[.seq]} – (also valid in $$BODY) Returns a URL to the
preferred image for the given animal ID. Animal IDs can be a $field from the
selected data. If the optional sequence number is given, then a link to image
seq (where seq is a 1-based count) for the animal is output instead. If seq
is invalid, or the animal doesn’t have a preferred image the default system
nopic.jpg file is used instead.</p></li>
<li><p>{CHIPMANUFACTURER.&lt;chipno&gt;} - (also valid in $$BODY) Returns the name of
the microchip manufacturer of the given chip number.</p></li>
<li><p>{QR.&lt;animalid&gt;[.size]} – (also valid in $$BODY) Returns a URL to the google
charting api to generate a QR code with a link to this animal’s record for
mobile devices. If size is not set, then 150x150 is used. Eg:
{QR.$ID.200x200}</p></li>
<li><p>{LAST.&lt;field&gt;} - Returns the last value for a given field in a group</p></li>
<li><p>{PCT.&lt;field&gt;.&lt;value&gt;[.round]} - Returns the percentage of rows in the group
where field &lt;field&gt; matches value &lt;value&gt;. Optionally, you can specify a
number of decimal places to round to. Eg: {PCT.Sex.1.2} Would show the
percentage of male animals in the group, rounded to 2 decimal places.</p></li>
<li><p>{SQL.&lt;sql command&gt;} - executes the SQL and outputs the value of the first
field. Eg: {SQL.SELECT COUNT(*) FROM animal}. This tag is also available in
the $$BODY block and can be used in conjunction with the field tags to
produce a subquery. Eg: Suppose you wanted to show the number of movements
attached to a particular animal without doing a group query with an inner
join to adoption. You could just use {SQL.SELECT COUNT(*) FROM adoption WHERE
AnimalID = $ID}</p></li>
<li><p>{SUBREPORT.&lt;title&gt;.&lt;parentkey&gt;[.&lt;parentarg&gt;]} - executes the custom report
with [title] and with the [parentkey] being the name of a field from the
current report data to pass down to the subreport. The report output is
embedded in the current report. You can use the $PARENTKEY$ field in the
subreport to access this value for filtering your data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can nest reports to an unlimited depth. You can pass an unlimited number of fields to a subreport, accessible as $PARENTARGX$ where X is the number of the argument you want to access in the subreport query.</p>
</div>
</li>
</ul>
<p>Here is an example report to show all animals currently on the shelter, with
their picture, grouped by their internal location and giving totals for each:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT animal.ID, animal.AnimalName, animal.ShelterCode, internalLocation.LocationName
FROM animal
INNER JOIN internallocation ON
animal.ShelterLocation = internallocation.ID
WHERE animal.Archived = 0
ORDER BY internalLocation.LocationName

$$HEADER
HEADER$$

$$GROUP_LocationName
$$HEAD
&lt;h2&gt;$LocationName&lt;/h2&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Code&lt;/th&gt;
&lt;th&gt;Picture&lt;/th&gt;
&lt;/tr&gt;
$$FOOT
&lt;/table&gt;
&lt;p&gt;&lt;b&gt;Total at $LocationName: {COUNT.AnimalName}&lt;/b&gt;&lt;/p&gt;
GROUP$$

$$BODY
&lt;tr&gt;
&lt;td&gt;$AnimalName&lt;/td&gt;
&lt;td&gt;$ShelterCode&lt;/td&gt;
&lt;td&gt;&lt;img src={IMAGE.$ID} width=300 height=200 /&gt;&lt;/td&gt;
&lt;/tr&gt;
BODY$$

$$FOOTER
FOOTER$$
</pre></div>
</div>
</div>
</div>
<div class="section" id="charts">
<h2>Charts<a class="headerlink" href="#charts" title="Permalink to this headline">¶</a></h2>
<img alt="_images/reports_chart.png" src="_images/reports_chart.png" />
<p>Charts work just like the reports. The difference is that instead of generating HTML, you just  choose a chart type from the type dropdown.</p>
<p>ASM will dissect the results of the query in the following way to generate a graph, depending on whether your query returns two or three columns.</p>
<div class="section" id="two-column-variant">
<h3>Two column variant<a class="headerlink" href="#two-column-variant" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Each row in your result data becomes a point on the X axis</p></li>
<li><p>The first column in each row is assumed to contain the name used for the
label on the X axis. Only string data should be used for the first column.</p></li>
<li><p>Each subsequent column is assumed to be a piece of data at that point on the
X axis (and thus gives the Y axis its scale). Only numeric data can appear
in columns after the first one.</p></li>
<li><p>The fieldname of each column after the label column is used to denote the
data on the legend.</p></li>
</ol>
<p>For example, this SQL will produce a graph that shows the amount of donations
from animal movements each year. Following our scheme, the Year column being
first is the X axis label, TotalAmount is the first datapoint for that item on
the X axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">YEAR</span><span class="p">(</span><span class="n">DateReceived</span><span class="p">)</span> <span class="n">AS</span> <span class="n">Year</span><span class="p">,</span>
<span class="n">SUM</span><span class="p">(</span><span class="n">ownerdonation</span><span class="o">.</span><span class="n">Donation</span><span class="p">)</span> <span class="n">AS</span> <span class="n">TotalAmount</span>
<span class="n">FROM</span> <span class="n">ownerdonation</span>
<span class="n">WHERE</span> <span class="n">MovementID</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">YEAR</span><span class="p">(</span><span class="n">DateReceived</span><span class="p">)</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">Year</span>
</pre></div>
</div>
<p>Would produce data that might look something like:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Year</p></th>
<th class="head"><p>TotalAmount</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2004</p></td>
<td><p>59840</p></td>
</tr>
<tr class="row-odd"><td><p>2005</p></td>
<td><p>61893</p></td>
</tr>
<tr class="row-even"><td><p>2006</p></td>
<td><p>51039</p></td>
</tr>
<tr class="row-odd"><td><p>2007</p></td>
<td><p>55984</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Graphs use a relative scale, interpreted from the data. If all of your column data is the same value, then the graph will not display because it has no variance.</p>
</div>
</div>
<div class="section" id="three-column-variant">
<h3>Three column variant<a class="headerlink" href="#three-column-variant" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Each row in your result data becomes a point on the X axis</p></li>
<li><p>The first column in each row is assumed to contain the name used for a
series.</p></li>
<li><p>The second column in each row contains the X axis label.</p></li>
<li><p>The third column contains the value for the Y axis and must be numeric.</p></li>
</ol>
<p>For example, this SQL produces a graph that shows the number of donations made
for over a year by internal location. Each location becomes a series with a set
of data points for each month of the year:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT i.LocationName,
MONTH(ad.MovementDate) AS bimonth,
COUNT(ad.Donation) AS total
FROM adoption ad
INNER JOIN animal a ON ad.AnimalID = a.ID
INNER JOIN internallocation i ON i.ID = a.ShelterLocation
WHERE YEAR(ad.MovementDate) = $ASK STRING Which year to display for?$
AND ad.MovementType = 1
GROUP BY i.LocationName, MONTH(ad.MovementDate)
</pre></div>
</div>
</div>
</div>
<div class="section" id="maps">
<h2>Maps<a class="headerlink" href="#maps" title="Permalink to this headline">¶</a></h2>
<p>Maps are just like the reports. The difference is that instead of generating
HTML, they will output map markers from a LatLong field.</p>
<p>ASM expects map queries to return a resultset containing two columns. The first
is the LatLong marker for the map, and the second is the text to display in the
popup when the marker is clicked.</p>
<p>For example, this SQL will produce a map that shows the location of every
person on file, with their address when the marker is clicked:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">LatLong</span><span class="p">,</span> <span class="n">OwnerAddress</span> <span class="n">FROM</span> <span class="n">owner</span>
</pre></div>
</div>
</div>
<div class="section" id="automatic-updating-of-repository-reports">
<h2>Automatic updating of repository reports<a class="headerlink" href="#automatic-updating-of-repository-reports" title="Permalink to this headline">¶</a></h2>
<p>When you install a report from the repository, some reports have a revision
number. This number will be shown in the list on the reports editing screen
next to the report’s title.</p>
<p>If we update the repository with a newer version of that report, it will get a new
revision number. Each time you visit the home page, the system will automatically
check for newer versions of reports. If it finds any, it will update the SQL and HTML
of your copy of the report to the latest version. It will only change the SQL/HTML
and update any subreports, it will not change the description if you updated it.</p>
<p>If you change the title or category on your copy of a report, this will prevent
it being updated by the auto updater. You can use this to lock a report to a
particular version.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="litters.html" class="btn btn-neutral float-right" title="Litters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="stockcontrol.html" class="btn btn-neutral float-left" title="Stock Control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Sheltermanager, Ltd.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>